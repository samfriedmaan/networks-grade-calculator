<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Networks Grade Calculator - Winter 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        
        /* Smooth transitions for dynamic header color */
        #result-banner { transition: background-color 0.5s ease; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen pb-12 text-gray-900">
    <div class="max-w-4xl mx-auto px-4 pt-8">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">Networks Grade Calculator</h1>
            <p class="text-gray-500 uppercase tracking-widest text-xs font-semibold">ECON 2040 • INFO 2040 • SOC 2090 • CS 2850</p>
        </header>

        <!-- Main Calculator Card -->
        <div class="bg-white rounded-3xl shadow-xl border border-gray-100 overflow-hidden">
            
            <!-- Dynamic Result Banner -->
            <div id="result-banner" class="bg-gray-800 text-white p-8 md:p-12 text-center">
                <div class="text-sm uppercase tracking-widest opacity-80 mb-2 font-bold">Projected Current Average</div>
                <div class="text-7xl font-black mb-4" id="final-letter">F</div>
                <div class="text-2xl font-medium opacity-90">
                    <span id="final-numeric">0.00</span>%
                </div>
                
                <div class="mt-8 pt-6 border-t border-white/20 grid grid-cols-2 gap-8 text-xs font-bold uppercase tracking-tight opacity-90">
                    <div>
                        <span class="block opacity-60 mb-1">Points Earned</span>
                        <span class="text-xl"><span id="points-earned">0.00</span> / 100</span>
                    </div>
                    <div>
                        <span class="block opacity-60 mb-1">Weight Graded</span>
                        <span class="text-xl"><span id="weight-attempted">0.00</span>%</span>
                    </div>
                </div>
            </div>

            <div class="p-6 md:p-10 space-y-12">
                
                <!-- Short Homeworks -->
                <section>
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-extrabold text-gray-800">Short Homeworks (40%)</h2>
                        <span class="px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-xs font-bold" id="short-hw-sum">Sum: 0 / 40 (Cap)</span>
                    </div>
                    <div class="grid grid-cols-3 sm:grid-cols-5 md:grid-cols-9 gap-3">
                        <div id="short-hw-inputs" class="contents"></div>
                    </div>
                </section>

                <hr class="border-gray-100">

                <!-- Long Assignments -->
                <section>
                    <h2 class="text-xl font-extrabold text-gray-800 mb-6">Long Assignments (20%)</h2>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div class="bg-gray-50 p-5 rounded-2xl border border-gray-100">
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-2">HW 4 (Out of 50)</label>
                            <input type="number" id="hw4" placeholder="Pending" min="0" max="50" step="0.5" class="save-state w-full bg-white px-4 py-3 border border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:outline-none transition-all text-lg font-bold">
                        </div>
                        <div class="bg-gray-50 p-5 rounded-2xl border border-gray-100">
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-2">HW 9 (Out of 35)</label>
                            <input type="number" id="hw9" placeholder="Pending" min="0" max="35" step="0.5" class="save-state w-full bg-white px-4 py-3 border border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-100 focus:outline-none transition-all text-lg font-bold">
                        </div>
                    </div>
                </section>

                <hr class="border-gray-100">

                <!-- Final Exam Section with Target Calculator -->
                <section class="bg-blue-50/50 p-6 md:p-10 rounded-3xl border border-blue-100/50">
                    <div class="grid lg:grid-cols-2 gap-10">
                        <div>
                            <h2 class="text-2xl font-black text-blue-900 mb-2">Final Exam (20%)</h2>
                            <p class="text-blue-700/70 text-sm mb-6">Enter your actual or estimated score below.</p>
                            <div class="max-w-xs">
                                <label class="block text-xs font-bold text-blue-700 uppercase mb-2 tracking-widest">Exam Score (0-50)</label>
                                <input type="number" id="exam" placeholder="Not Taken" min="0" max="50" step="0.5" class="save-state w-full px-4 py-4 border-2 border-blue-200 rounded-2xl focus:ring-4 focus:ring-blue-200 focus:outline-none transition-all text-3xl font-black text-blue-900 shadow-sm">
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-2xl border border-blue-100 shadow-sm">
                            <h3 class="text-blue-900 font-bold text-sm uppercase tracking-widest mb-4">Exam Scores Needed for Target Grade:</h3>
                            <div id="target-scores" class="space-y-2 text-sm">
                                <!-- Populated by JS -->
                                <div class="text-gray-400 italic">Enter your other grades to see targets...</div>
                            </div>
                        </div>
                    </div>
                </section>

                <hr class="border-gray-100">

                <!-- Vertical Attendance & Participation -->
                <section>
                    <div class="flex flex-col md:flex-row md:items-center justify-between mb-8">
                        <h2 class="text-xl font-extrabold text-gray-800">Class Engagement (20%)</h2>
                        <div class="text-[10px] font-bold uppercase text-gray-400">1 point each per class (12 total)</div>
                    </div>
                    
                    <div class="space-y-2 max-w-xl mx-auto md:mx-0">
                        <div class="grid grid-cols-12 gap-4 px-4 py-2 text-[10px] font-black text-gray-400 uppercase tracking-widest border-b border-gray-100">
                            <div class="col-span-6">Session</div>
                            <div class="col-span-3 text-center">Attend (A)</div>
                            <div class="col-span-3 text-center">Partic (P)</div>
                        </div>
                        <div id="engagement-inputs" class="space-y-1"></div>
                    </div>
                </section>

                <hr class="border-gray-100">

                <!-- Extra Credit -->
                <section class="flex items-center justify-between bg-emerald-50 p-6 rounded-2xl border border-emerald-100">
                    <div>
                        <h3 class="font-bold text-emerald-900">Course Evaluation</h3>
                        <p class="text-xs text-emerald-700 font-medium">Earn +1% flat extra credit for completing the evaluation</p>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer scale-125">
                        <input type="checkbox" id="extra-credit" class="save-state sr-only peer">
                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-600"></div>
                    </label>
                </section>
            </div>
        </div>

        <!-- Legend and Tools -->
        <div class="mt-8 text-center space-y-6">
            <div class="text-gray-400 text-[10px] font-bold uppercase tracking-widest space-y-2">
                <div>Rounding Rule: Nearest Integer (92.50 rounds to 93) • Caps: 40/54 points for Short HW full credit</div>
                <div class="text-gray-300">Created for Networks ECON/INFO/CS Winter 2026</div>
            </div>
            
            <button onclick="resetCalculator()" class="text-xs font-bold text-gray-400 hover:text-red-500 transition-colors uppercase tracking-widest border-b border-transparent hover:border-red-200">
                Clear all data and reset
            </button>
        </div>
    </div>

    <script>
        const shortHwList = [1, 2, 3, 5, 6, 7, 8, 10, 11]; 
        const shortHwContainer = document.getElementById('short-hw-inputs');
        const engagementContainer = document.getElementById('engagement-inputs');

        // Setup Short HWs
        shortHwList.forEach(num => {
            const div = document.createElement('div');
            div.className = "flex flex-col text-center";
            div.innerHTML = `
                <label class="text-[10px] font-black text-gray-400 mb-1">HW ${num}</label>
                <input type="number" id="short-hw-${num}" step="0.25" min="0" max="6" placeholder="-" class="short-hw-input save-state w-full px-1 py-3 border border-gray-200 rounded-xl text-center font-bold focus:border-blue-500 focus:outline-none">
            `;
            shortHwContainer.appendChild(div);
        });

        // Setup Engagement Checkboxes (Vertical List)
        for (let i = 1; i <= 12; i++) {
            const div = document.createElement('div');
            div.className = "grid grid-cols-12 gap-4 items-center p-3 rounded-xl border border-gray-50 hover:bg-gray-50 transition-colors";
            div.innerHTML = `
                <div class="col-span-6 font-bold text-gray-700 flex items-center">
                    <span class="w-6 h-6 rounded-full bg-gray-200 text-[10px] flex items-center justify-center mr-3 text-gray-500">${i}</span>
                    Class ${i}
                </div>
                <div class="col-span-3 flex justify-center">
                    <input type="checkbox" id="att-${i}" class="att-box save-state w-6 h-6 rounded-md border-gray-300 text-blue-600 focus:ring-blue-500 transition-all">
                </div>
                <div class="col-span-3 flex justify-center">
                    <input type="checkbox" id="part-${i}" class="part-box save-state w-6 h-6 rounded-md border-gray-300 text-purple-600 focus:ring-purple-500 transition-all">
                </div>
            `;
            engagementContainer.appendChild(div);
        }

        // Functions for LocalStorage
        function saveToLocalStorage() {
            const state = {};
            document.querySelectorAll('.save-state').forEach(input => {
                if (input.type === 'checkbox') {
                    state[input.id] = input.checked;
                } else {
                    state[input.id] = input.value;
                }
            });
            localStorage.setItem('networks_grade_state', JSON.stringify(state));
        }

        function loadFromLocalStorage() {
            const saved = localStorage.getItem('networks_grade_state');
            if (!saved) return;
            try {
                const state = JSON.parse(saved);
                Object.keys(state).forEach(id => {
                    const input = document.getElementById(id);
                    if (input) {
                        if (input.type === 'checkbox') {
                            input.checked = state[id];
                        } else {
                            input.value = state[id];
                        }
                    }
                });
            } catch (e) {
                console.error("Failed to load saved state", e);
            }
        }

        function resetCalculator() {
            if (confirm("Are you sure you want to clear all grades and checkboxes? This cannot be undone.")) {
                localStorage.removeItem('networks_grade_state');
                window.location.reload();
            }
        }

        function calculate() {
            let totalActualPoints = 0;
            let totalProjectedContribution = 0;
            let totalWeightAttempted = 0;

            // 1. Short HWs (40%)
            let shortSum = 0;
            let shortCount = 0;
            document.querySelectorAll('.short-hw-input').forEach(i => {
                if (i.value !== "") {
                    shortSum += parseFloat(i.value || 0);
                    shortCount++;
                }
            });
            
            const shortActual = Math.min(40, shortSum);
            totalActualPoints += shortActual;
            
            if (shortCount > 0) {
                const categoryWeight = 40;
                const pointsPossibleSoFar = shortCount * 6;
                const weightAttempted = (pointsPossibleSoFar / 54) * categoryWeight;
                const performanceRatio = shortSum / pointsPossibleSoFar;
                totalProjectedContribution += performanceRatio * weightAttempted;
                totalWeightAttempted += weightAttempted;
            }
            document.getElementById('short-hw-sum').innerText = `Sum: ${shortSum.toFixed(2)} / 40 (Cap)`;

            // Helper for numeric inputs
            const handleNumeric = (id, max, weight) => {
                const el = document.getElementById(id);
                if (el.value !== "") {
                    const score = parseFloat(el.value || 0);
                    const contrib = (score / max) * weight;
                    totalActualPoints += contrib;
                    totalProjectedContribution += contrib;
                    totalWeightAttempted += weight;
                }
            };

            handleNumeric('hw4', 50, 10);
            handleNumeric('hw9', 35, 10);
            handleNumeric('exam', 50, 20);

            // 2. Engagement (10% + 10%)
            const attBoxes = document.querySelectorAll('.att-box');
            const partBoxes = document.querySelectorAll('.part-box');
            
            let attCount = 0;
            let partCount = 0;
            let highestClassCompleted = 0;

            for (let i = 0; i < 12; i++) {
                const attChecked = attBoxes[i].checked;
                const partChecked = partBoxes[i].checked;
                if (attChecked) attCount++;
                if (partChecked) partCount++;
                if (attChecked || partChecked) highestClassCompleted = i + 1;
            }

            const attContrib = (attCount / 12) * 10;
            const partContrib = (partCount / 12) * 10;
            totalActualPoints += (attContrib + partContrib);

            if (highestClassCompleted > 0) {
                const engagementWeightSoFar = (highestClassCompleted / 12) * 20; 
                totalProjectedContribution += (attContrib + partContrib);
                totalWeightAttempted += engagementWeightSoFar;
            }

            // 3. Extra Credit
            const extra = document.getElementById('extra-credit').checked ? 1 : 0;
            totalActualPoints += extra;
            totalProjectedContribution += extra;

            // Final Stats
            let finalNumeric = 0;
            if (totalWeightAttempted > 0) {
                finalNumeric = (totalProjectedContribution / totalWeightAttempted) * 100;
                finalNumeric = Math.min(101, finalNumeric);
            }
            
            const rounded = Math.round(finalNumeric);
            const letter = getLetter(rounded);

            document.getElementById('final-numeric').innerText = finalNumeric.toFixed(2);
            document.getElementById('points-earned').innerText = totalActualPoints.toFixed(2);
            document.getElementById('weight-attempted').innerText = totalWeightAttempted.toFixed(2);
            document.getElementById('final-letter').innerText = letter;

            updateHeaderColor(letter);
            updateTargetScores(totalActualPoints, document.getElementById('exam').value !== "");
            
            // Auto-save on every calculation
            saveToLocalStorage();
        }

        function updateTargetScores(currentPoints, examEntered) {
            const container = document.getElementById('target-scores');
            const examVal = parseFloat(document.getElementById('exam').value || 0);
            const basePoints = currentPoints - ((examVal / 50) * 20);

            const targets = [
                { name: 'A+', score: 97.5 },
                { name: 'A',  score: 92.5 },
                { name: 'A-', score: 89.5 },
                { name: 'B+', score: 87.5 },
                { name: 'B',  score: 82.5 },
                { name: 'B-', score: 79.5 },
                { name: 'C+', score: 77.5 },
                { name: 'C',  score: 72.5 },
                { name: 'C-', score: 69.5 }
            ];

            container.innerHTML = '';
            
            targets.forEach(t => {
                const neededPoints = (t.score - basePoints) * 2.5;
                const row = document.createElement('div');
                row.className = "flex justify-between items-center py-1 border-b border-blue-50 last:border-0";
                
                let textResult = '';
                let colorClass = 'text-gray-600';

                if (neededPoints <= 0) {
                    textResult = 'LOCKED IN';
                    colorClass = 'text-emerald-600 font-black';
                } else if (neededPoints > 50) {
                    textResult = 'Impossible';
                    colorClass = 'text-red-400 opacity-50';
                } else {
                    textResult = `${neededPoints.toFixed(1)} / 50`;
                    colorClass = 'text-blue-600 font-bold';
                }

                row.innerHTML = `
                    <span class="font-bold text-blue-900">${t.name} <span class="text-[10px] font-normal text-blue-300">(${t.score}+)</span></span>
                    <span class="${colorClass}">${textResult}</span>
                `;
                container.appendChild(row);
            });
        }

        function getLetter(score) {
            if (score >= 98) return "A+";
            if (score >= 93) return "A";
            if (score >= 90) return "A-";
            if (score >= 88) return "B+";
            if (score >= 83) return "B";
            if (score >= 80) return "B-";
            if (score >= 78) return "C+";
            if (score >= 73) return "C";
            if (score >= 70) return "C-";
            if (score >= 60) return "D";
            return "F";
        }

        function updateHeaderColor(letter) {
            const banner = document.getElementById('result-banner');
            banner.classList.remove('bg-gray-800', 'bg-emerald-600', 'bg-lime-500', 'bg-yellow-500', 'bg-orange-500', 'bg-red-600', 'bg-sky-600');
            
            if (letter.startsWith('A')) banner.classList.add('bg-emerald-600');
            else if (letter.startsWith('B')) banner.classList.add('bg-lime-500');
            else if (letter.startsWith('C')) banner.classList.add('bg-yellow-500');
            else if (letter === 'D') banner.classList.add('bg-orange-500');
            else if (letter === 'F') banner.classList.add('bg-red-600');
            else banner.classList.add('bg-gray-800');
        }

        // Initialize
        loadFromLocalStorage();
        
        // Listeners
        document.querySelectorAll('input').forEach(i => {
            const eventType = i.type === 'checkbox' ? 'change' : 'input';
            i.addEventListener(eventType, calculate);
        });

        calculate(); // Initial run
    </script>
</body>
</html>
